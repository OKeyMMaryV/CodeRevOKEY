#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс
	
// Функция получает соответствие коэффицентов номерам периодов для профиля.
//
// Параметры:
//  ПрофильРаспределения - СправочникСсылка.бит_ПрофилиРаспределенияПоПериодам - профиль распределения.
//  Режим				 - Строка - режим.
// 
// Возвращаемое значение:
//  Коэффициенты - Соответствие - Значения коэффициентов.
//
Функция ПолучитьКоээфициенты(ПрофильРаспределения, Режим = "П") Экспорт
	
	Коэффициенты = Новый Соответствие;
	Для каждого СтрокаКоэффициент Из ПрофильРаспределения.Профиль Цикл
		
		Коэффициент = ?(Режим = "К", СтрокаКоэффициент.Процент/100, СтрокаКоэффициент.Процент);
		Коэффициенты.Вставить(СтрокаКоэффициент.НомерПериода, Коэффициент);
		
	КонецЦикла; 
	
	Возврат Коэффициенты;
	
КонецФункции // ПолучитьКоээфициенты()

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

// Процедура заполняет вид профиля распределения.
//
Процедура ЗаполнитьВидПрофиляРаспределенияПриОбновлении() Экспорт

	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Таблица.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.бит_ПрофилиРаспределенияПоПериодам КАК Таблица
	|ГДЕ
	|	Таблица.Вид = ЗНАЧЕНИЕ(Перечисление.бит_ВидыПрофилейРаспределения.ПустаяСсылка)";	
	
	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать();
	Пока Выборка.Следующий() Цикл
		ТекущийОбъект = Выборка.Ссылка.ПолучитьОбъект();
		ТекущийОбъект.Вид = Перечисления.бит_ВидыПрофилейРаспределения.ПоПериодам;
		ОбновлениеИнформационнойБазы.ЗаписатьДанные(ТекущийОбъект);	
	КонецЦикла; 
	
КонецПроцедуры // ЗаполнитьВидПрофиляРаспределенияПриОбновлении()

#КонецОбласти 

#КонецЕсли
