#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
#Область ПрограммныйИнтерфейс

// Функция создает и записывает элемент справочника бит_ВариантыОтчетов.
//
// Параметры:
//  СтруктураПараметров	 - Структура - Структура параметров.
// 
// Возвращаемое значение:
//  РезВариант - СправочникСсылка.бит_ВариантыОтчетов - вариант отчета.
//
Функция СоздатьВариант(СтруктураПараметров) Экспорт

	УстановитьПривилегированныйРежим(Истина);
	
	СпрОб = Справочники.бит_ВариантыОтчетов.СоздатьЭлемент();  
	ЗаполнитьЗначенияСвойств(СпрОб, СтруктураПараметров);
	СпрОб.КлючВарианта = Строка(Новый УникальныйИдентификатор());
	
	флДействиеВыполнено = бит_ОбщегоНазначения.ЗаписатьСправочник(СпрОб, , "Ошибки");
	
	Если флДействиеВыполнено Тогда
		РезВариант = СпрОб.Ссылка; 
	Иначе	
	   	РезВариант = Справочники.бит_ВариантыОтчетов.ПустаяСсылка();
	КонецЕсли; 
	
	УстановитьПривилегированныйРежим(Ложь);
	                   	
	Возврат РезВариант;
	
КонецФункции // СоздатьВариант()

#КонецОбласти
 
#КонецЕсли
