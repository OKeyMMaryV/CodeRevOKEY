#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныйПрограммныйИнтерфейс

// Функция возвращает перечень алгоритмов, доступных для элементов таблиц.
//
// Возвращаемое значение:
//  Алгоритмы - Массив.
//
Функция ПереченьАлгоритмов() Экспорт

    Алгоритмы = Новый Массив;

    Алгоритмы.Добавить("Итог");

    Возврат Алгоритмы;
	
КонецФункции // ПереченьАлгоритмов()

// Функция определяет максимальный код сортировки.
//
// Возвращаемое значение:
//  КодСортировки - Число.
//
Функция МаксимальныйКодСортировки(НастройкаОтчета, ВидЭлемента) Экспорт

	КодСортировки = 0;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Владелец", НастройкаОтчета);
	Запрос.УстановитьПараметр("Вид", ВидЭлемента);
	
	Запрос.Текст = "ВЫБРАТЬ
	               |	МАКСИМУМ(ТабСпр.КодСортировки) КАК КодСортировки
	               |ИЗ
	               |	Справочник.бит_мпд_ЭлементыТаблицПроизвольныхОтчетов КАК ТабСпр
	               |ГДЕ
	               |	ТабСпр.Владелец = &Владелец
	               |	И ТабСпр.Вид = &Вид";
				   
	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать();
	
	Если Выборка.Следующий() Тогда
	
		 КодСортировки = ?(ТипЗнч(Выборка.КодСортировки) = Тип("Число"), Выборка.КодСортировки, 0);
	
	КонецЕсли; 

	Возврат КодСортировки;
	
КонецФункции // МаксимальныйКодификатор()

#КонецОбласти
 
#КонецЕсли
