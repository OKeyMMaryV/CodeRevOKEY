
#Область ОбработчикиСобытийФормы

// Процедура - обработчик события "ПриСозданииНаСервере" формы.
// 
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ИмяДополнительногоПоля_СчетДт = "ДополнительноеПоле_СчетДт";
	ИмяДополнительногоПоля_СчетКт = "ДополнительноеПоле_СчетКт";
	
	ИмяПоляПриемника_СчетДт = "СчетДт";
	ИмяПоляПриемника_СчетКт = "СчетКт";
	
	ШаблонВыражения = "// добавление новой проводки в приемник
                      |Если НЕ Отказ  Тогда
                      |
                      | СтруктураИменДоп = Новый Структура;
                      | СтруктураИменДоп.Вставить(""ИмяДополнительногоПоля_СчетДт"",""%ИмяДополнительногоПоля_СчетДт%"");
                      | СтруктураИменДоп.Вставить(""ИмяДополнительногоПоля_СчетКт"",""%ИмяДополнительногоПоля_СчетКт%"");
                      | СтруктураИменДоп.Вставить(""ИмяПоляПриемника_СчетДт"",""%ИмяПоляПриемника_СчетДт%"");
                      | СтруктураИменДоп.Вставить(""ИмяПоляПриемника_СчетКт"",""%ИмяПоляПриемника_СчетКт%"");
                      |
                      | НоваяПроводка = ДобавитьДополнительнуюПроводку(НаборПриемник, ЗаписьИсточник, ЗаписьПриемник, ДополнительныеДанные, СтруктураИменДоп);
					  | Если НЕ НоваяПроводка = Неопределено Тогда
                      |   ЗаполнитьЗаписьСоответствияДвижений(НаборСоответствие, СтруктураШапкиДокумента, СтруктураПараметров, Ном, НомПриемник);
                      |   НомПриемник = НомПриемник + 1;
                      | КонецЕсли;   
                      |
                      |КонецЕсли;";
					  
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	ОбновитьВыражениеРезультат();
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура ИмяДополнительногоПоля_СчетДтПриИзменении(Элемент)
	
	ОбновитьВыражениеРезультат();
	
КонецПроцедуры

&НаКлиенте
Процедура ИмяДополнительногоПоля_СчетКтПриИзменении(Элемент)
	
	ОбновитьВыражениеРезультат();
	
КонецПроцедуры

&НаКлиенте
Процедура ИмяПоляПриемника_СчетДтПриИзменении(Элемент)
	
	ОбновитьВыражениеРезультат();
	
КонецПроцедуры

&НаКлиенте
Процедура ИмяПоляПриемника_СчетКтПриИзменении(Элемент)
	
	ОбновитьВыражениеРезультат();
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

// Процедура - действие команды "КомандаОК".
// 
&НаКлиенте
Процедура КомандаОК(Команда)
	
	ОбновитьВыражениеРезультат();
	Закрыть(ВыражениеРезультат);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Функция выполняет обновление результирующего выражения.
// 
&НаКлиенте
Процедура ОбновитьВыражениеРезультат()

	ВыражениеРезультат = ШаблонВыражения;
	ВыражениеРезультат = СтрЗаменить(ВыражениеРезультат, "%ИмяДополнительногоПоля_СчетДт%", ИмяДополнительногоПоля_СчетДт);
	ВыражениеРезультат = СтрЗаменить(ВыражениеРезультат, "%ИмяДополнительногоПоля_СчетКт%", ИмяДополнительногоПоля_СчетКт);
	
	ВыражениеРезультат = СтрЗаменить(ВыражениеРезультат, "%ИмяПоляПриемника_СчетДт%"      , ИмяПоляПриемника_СчетДт);
	ВыражениеРезультат = СтрЗаменить(ВыражениеРезультат, "%ИмяПоляПриемника_СчетКт%"      , ИмяПоляПриемника_СчетКт);
	
	
КонецПроцедуры // ОбновитьВыражениеРезультат()

#КонецОбласти

