
Функция ПроверитьГраницыПериодов(ДатаПроверки, Организация, Раздел) Экспорт

	// Получить Границу запрета изменения данных
	//ОКЕЙ Поздняков А.С. (СофтЛаб) Начало 2020-07-24 (#3820)
	//Запрос = Новый Запрос;
	//Запрос.Текст = "ВЫБРАТЬ
	//               |	ГраницыЗапретаИзмененияДанных.ДатаЗапрета КАК ГраницаЗапретаИзменений
	//               |ИЗ
	//               |	РегистрСведений.ДатыЗапретаИзменения КАК ГраницыЗапретаИзмененияДанных
	//               |ГДЕ
	//               |	ГраницыЗапретаИзмененияДанных.Объект = &Организация
	//               |	И ГраницыЗапретаИзмененияДанных.Раздел = &Раздел";
	//
	//Запрос.УстановитьПараметр("Раздел", Раздел);
	//Запрос.УстановитьПараметр("Организация", Организация);
	//
	//ЗапросВыполнить = Запрос.Выполнить();
	//Если ЗапросВыполнить.Пустой() Тогда
	//	Граница = Неопределено;
	//Иначе
	//	Граница = Запрос.Выполнить().Выгрузить()[0].ГраницаЗапретаИзменений;
	//КонецЕсли;
	//
	// Если ДатаПроверки <> Неопределено И Граница <> Неопределено Тогда
	//	Если ДатаПроверки < Граница Тогда
	//		Возврат Ложь;
	//	КонецЕсли;	
	//КонецЕсли;
	//
	//Возврат Истина;
	
	Возврат ОК_ОбщегоНазначения.ПроверитьГраницыПериодов(ДатаПроверки, Организация, Раздел);
	//ОКЕЙ Поздняков А.С. (СофтЛаб) Конец 2020-07-24 (#3820)
	
КонецФункции

Функция ПроверитьГраницыПериодовМСФО(ДатаПроверки, Организация) Экспорт
	
	//ОКЕЙ Поздняков А.С. (СофтЛаб) Начало 2020-07-24 (#3820)
	//флЗакрытыйПериод = Истина;
	//
	//РегистрыКонтроля = Новый Соответствие;
	//
	//ОбъектСистемы = Справочники.бит_ОбъектыСистемы.НайтиПоРеквизиту("ИмяОбъектаПолное", "РегистрБухгалтерии.бит_Дополнительный_2");
	//		
	//ТаблицаДат = бит_ОбщегоНазначения.ПолучитьЗначениеПеременной("бит_НачалоОткрытогоПериода");
	//	
	//Если ТаблицаДат.Количество()>0 Тогда
	//	
	//	Запрос = Новый Запрос;
	//	Запрос.УстановитьПараметр("ТаблицаДат"       ,ТаблицаДат);
	//	Запрос.УстановитьПараметр("Организация"      ,Организация);
	//	Запрос.УстановитьПараметр("ОбъектСистемы"    ,ОбъектСистемы);
	//	Запрос.УстановитьПараметр("ПустаяДата"       ,Дата('00010101'));
	//	
	//	Запрос.Текст = "ВЫБРАТЬ
	//	|	ТаблицаДат.Организация,
	//	|	ТаблицаДат.ОбъектСистемы,
	//	|	ТаблицаДат.ДатаОткрытогоПериода
	//	|ПОМЕСТИТЬ ТаблицаДат
	//	|ИЗ
	//	|	&ТаблицаДат КАК ТаблицаДат
	//	|ГДЕ
	//	|	ТаблицаДат.ОбъектСистемы = &ОбъектСистемы
	//	|	И ТаблицаДат.ДатаОткрытогоПериода <> &ПустаяДата
	//	|;
	//	|
	//	|////////////////////////////////////////////////////////////////////////////////
	//	|ВЫБРАТЬ
	//	|	1 КАК Приоритет,
	//	|	ТаблицаДат.ОбъектСистемы,
	//	|	ТаблицаДат.ДатаОткрытогоПериода
	//	|ИЗ
	//	|	ТаблицаДат КАК ТаблицаДат
	//	|ГДЕ
	//	|	ТаблицаДат.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	//	|
	//	|ОБЪЕДИНИТЬ ВСЕ
	//	|
	//	|ВЫБРАТЬ
	//	|	0,
	//	|	ТаблицаДат.ОбъектСистемы,
	//	|	ТаблицаДат.ДатаОткрытогоПериода
	//	|ИЗ
	//	|	ТаблицаДат КАК ТаблицаДат
	//	|ГДЕ
	//	|	ТаблицаДат.Организация = &Организация
	//	|
	//	|УПОРЯДОЧИТЬ ПО
	//	|	Приоритет
	//	|;
	//	|
	//	|////////////////////////////////////////////////////////////////////////////////
	//	|УНИЧТОЖИТЬ ТаблицаДат";
	//	
	//	Результат = Запрос.Выполнить();
	//	
	//	Выборка   = Результат.Выбрать();

	//	Пока Выборка.Следующий() Цикл
	//		
	//		РегистрыКонтроля.Вставить(Выборка.ОбъектСистемы,Выборка.ДатаОткрытогоПериода);
	//		ДатаОткрытогоПериода = Выборка.ДатаОткрытогоПериода;
	//		
	//	КонецЦикла; 
	//	
	//КонецЕсли;
	//
	//Если РегистрыКонтроля.Количество() > 0 Тогда
	//	
	//	Если ДатаПроверки < ДатаОткрытогоПериода Тогда
	//		
	//		флЗакрытыйПериод = Ложь;
	//		
	//	КонецЕсли; 
	//	
	//КонецЕсли;
	//
	//Возврат флЗакрытыйПериод;
	
	Возврат ОК_ОбщегоНазначения.ПроверитьГраницыПериодовМСФО(ДатаПроверки, Организация);
	//ОКЕЙ Поздняков А.С. (СофтЛаб) Конец 2020-07-24 (#3820)
	
КонецФункции