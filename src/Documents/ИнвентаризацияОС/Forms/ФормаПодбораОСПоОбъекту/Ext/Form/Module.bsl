

&НаСервере
Функция ОсновныеДействияФормыВыполнить_Сервер()
		// Вставить содержимое обработчика.
	Запрос =новый Запрос();
	Запрос.УстановитьПараметр("ДатаОстатков",  Дата);
	Запрос.УстановитьПараметр("Организация",   Организация);
	ЗАпрос.Текст="ВЫБРАТЬ
	             |	МестонахождениеОСБухгалтерскийУчет.ОсновноеСредство КАК ОсновноеСредство,
	             |	МестонахождениеОСБухгалтерскийУчет.Местонахождение КАК ПодразделениеОрганизации,
	             |	СчетаБухгалтерскогоУчетаОССрезПоследних.СчетУчета КАК СчетУчета
	             |ИЗ
	             |	(ВЫБРАТЬ
	             |		МестонахождениеОСБухгалтерскийУчет.ОсновноеСредство КАК ОсновноеСредство,
	             |		МестонахождениеОСБухгалтерскийУчет.Местонахождение КАК Местонахождение
	             |	ИЗ
	             |		(ВЫБРАТЬ
	             |			МестонахождениеОСБухгалтерскийУчетСрезПоследних.ОсновноеСредство КАК ОсновноеСредство,
	             |			МестонахождениеОСБухгалтерскийУчетСрезПоследних.Местонахождение КАК Местонахождение
	             |		ИЗ
	             |			РегистрСведений.МестонахождениеОСБухгалтерскийУчет.СрезПоследних(&ДатаОстатков, Организация = &Организация) КАК МестонахождениеОСБухгалтерскийУчетСрезПоследних) КАК МестонахождениеОСБухгалтерскийУчет) КАК МестонахождениеОСБухгалтерскийУчет
	             |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СчетаБухгалтерскогоУчетаОС.СрезПоследних(&ДатаОстатков, Организация = &Организация) КАК СчетаБухгалтерскогоУчетаОССрезПоследних
	             |		ПО МестонахождениеОСБухгалтерскийУчет.ОсновноеСредство = СчетаБухгалтерскогоУчетаОССрезПоследних.ОсновноеСредство
	             |			И (СчетаБухгалтерскогоУчетаОССрезПоследних.ОсновноеСредство.Объект В (&Объект))
	             |ГДЕ
	             |	НЕ СчетаБухгалтерскогоУчетаОССрезПоследних.ОсновноеСредство В
	             |				(ВЫБРАТЬ РАЗЛИЧНЫЕ
	             |					СостоянияОСОрганизаций.ОсновноеСредство КАК ОсновноеСредство
	             |				ИЗ
	             |					РегистрСведений.СостоянияОСОрганизаций.СрезПоследних(&ДатаОстатков, Организация = &Организация) КАК СостоянияОСОрганизаций
	             |				ГДЕ
	             |					СостоянияОСОрганизаций.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияОС.СнятоСУчета))";
	Запрос.УстановитьПараметр("Объект", Объект);
	
	Запрос.Текст=СтрЗаменить(Запрос.Текст,"имяКолонки",имяКолонки);
	результат=Запрос.Выполнить().Выгрузить();
	стРезультат = Новый Массив;
	Для Каждого текСтрока Из результат Цикл
		стРезультат.Добавить(Новый Структура("ОсновноеСредство,ПодразделениеОрганизации,СчетУчета", текСтрока.ОсновноеСредство, текСтрока.ПодразделениеОрганизации, текСтрока.СчетУчета));
	КонецЦикла;
	Возврат стРезультат;
КонецФункции


&НаКлиенте
Процедура ОсновныеДействияФормыВыполнить(Команда)
	стРезультат = ОсновныеДействияФормыВыполнить_Сервер();
	Для Каждого текСтрока Из стРезультат Цикл
		НоваяСтрока = ЭтаФорма.ВладелецФормы.Объект.ОС.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтрока, текСтрока);
	КонецЦикла;
	Закрыть();

КонецПроцедуры

имяКолонки="ОсновноеСредство";
