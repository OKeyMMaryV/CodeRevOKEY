#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

Функция ПолучитьЗначениеДопСведения(Объекты, Свойство, Значение = Неопределено, фВернутьТаблицу = Ложь) Экспорт 
	
	Запрос = Новый Запрос("ВЫБРАТЬ
	                      |	ДополнительныеСведения.Значение,
	                      |	ДополнительныеСведения.Объект
	                      |ИЗ
	                      |	РегистрСведений.ДополнительныеСведения КАК ДополнительныеСведения
	                      |ГДЕ
	                      |	ДополнительныеСведения.Объект В(&Объекты)
	                      |	И ДополнительныеСведения.Свойство = &Свойство
						  |	И ДополнительныеСведения.Значение = &Значение");
						  
	Запрос.УстановитьПараметр("Объекты", Объекты);
	Запрос.УстановитьПараметр("Свойство", Свойство);
	Запрос.УстановитьПараметр("Значение", Значение);
	
	Если Значение = Неопределено Тогда 
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "И ДополнительныеСведения.Значение = &Значение", "");
	КонецЕсли;
	
	Если фВернутьТаблицу Тогда 
		Возврат Запрос.Выполнить().Выгрузить();
	КонецЕсли;
	
	ВыборкаПоОбъекту = Запрос.Выполнить().Выбрать();
	
	Если ВыборкаПоОбъекту.Следующий() Тогда
		Возврат ВыборкаПоОбъекту.Значение;
	КонецЕсли;
	
	Возврат Неопределено;
	
КонецФункции

Функция ПроверитьТип(ОбъектПроверки, ПроверяемыйТип) Экспорт 
		
	Значение = ПолучитьЗначениеДопСведения(ОбъектПроверки, ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоНаименованию("Формат объекта (Объект строительства)"), ПроверяемыйТип);
	
	Возврат ?(Значение = Неопределено, Ложь, Истина);
	
КонецФункции

Функция ПолучитьОбъектПоФормату(Город,Формат) Экспорт 
	
	Запрос = Новый Запрос("ВЫБРАТЬ РАЗЛИЧНЫЕ
	                      |	ОбъектыСтроительства.Ссылка
	                      |ИЗ
	                      |	Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
						  |ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ДополнительныеСведения КАК ДополнительныеСведенияГород
						  |ПО ДополнительныеСведенияГород.Свойство = &СвойствоГород
						  |	И ДополнительныеСведенияГород.Значение = &Город
						  |	И ДополнительныеСведенияГород.Объект = ОбъектыСтроительства.Ссылка
						  |ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ДополнительныеСведения КАК ДополнительныеСведенияФормат
						  |ПО ДополнительныеСведенияФормат.Свойство = &СвойствоФормат
						  |	И ДополнительныеСведенияФормат.Значение = &Формат
						  |	И ДополнительныеСведенияФормат.Объект = ОбъектыСтроительства.Ссылка");
						  
	Запрос.УстановитьПараметр("СвойствоГород",ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоНаименованию("Город объекта (Объект строительства)"));
	Запрос.УстановитьПараметр("СвойствоФормат",ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоНаименованию("Формат объекта (Объект строительства)"));
	Запрос.УстановитьПараметр("Город",Город);
	Запрос.УстановитьПараметр("Формат",Формат);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда
		Возврат Выборка.Объект;
	Иначе 
		Возврат Неопределено;
	КонецЕсли;
	
КонецФункции

#КонецЕсли