#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	МетаданныеОбъекта = Метаданные.РегистрыСведений.бит_мпд_НазначениеПравилПоискаДанных;
	
	// Вызов механизма защиты
	
	бит_РаботаСДиалогамиСервер.ФормаЗаписиРегистраПриСозданииНаСервере(Отказ, СтандартнаяОбработка, ЭтотОбъект);

	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
КонецПроцедуры // ПриСозданииНаСервере()

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

// Процедура - обработчик события "ПриИзменении" поля ввода "ПравилоПоискаДанных".
// 
&НаКлиенте
Процедура ПравилоПоискаДанныхПриИзменении(Элемент)
	
	ИзменениеПравилаПоиска();	
	
КонецПроцедуры // ПравилоПоискаДанныхПриИзменении()

#КонецОбласти

#Область ОбработчикиКомандФормы

// Процедура - обработчик команды "КомандаПоменятьМестамиВидыИБ".
// 
&НаКлиенте
Процедура КомандаПоменятьМестамиВидыИБ(Команда)
	
	ТемпВидИБ = Запись.ВидИнформационнойБазыИсточник;
	Запись.ВидИнформационнойБазыИсточник = Запись.ВидИнформационнойБазыПриемник;
	Запись.ВидИнформационнойБазыПриемник = ТемпВидИБ;
	
	Если ЗначениеЗаполнено(Запись.ПравилоПоискаДанных) Тогда
		УстановитьИмяОбъектаИсточник();
	КонецЕсли;	
	
КонецПроцедуры // КомандаПоменятьМестамиВидыИБ()

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Процедура меняет местами виды ИБ.
// 
// Параметры:
//  Нет
// 
&НаСервере
Процедура УстановитьИмяОбъектаИсточник()

	ПравилоПоискаДанных = Запись.ПравилоПоискаДанных;
	ИсточникВидИБ 		= Запись.ВидИнформационнойБазыИсточник;
	
	Если ЗначениеЗаполнено(ПравилоПоискаДанных) Тогда
		
		Если ПравилоПоискаДанных.ВидИнформационнойБазы_1 = ИсточникВидИБ Тогда
			Запись.ИмяОбъектаИсточник = ПравилоПоискаДанных.ИмяОбъектаПолное_1;
		ИначеЕсли ПравилоПоискаДанных.ВидИнформационнойБазы_2 = ИсточникВидИБ Тогда
			Запись.ИмяОбъектаИсточник = ПравилоПоискаДанных.ИмяОбъектаПолное_2;
		Иначе	
		    Запись.ИмяОбъектаИсточник = "";
			ПравилоПоискаДанных = Справочники.бит_мпд_ПравилаПоискаДанных.ПустаяСсылка();
		КонецЕсли;
		
	КонецЕсли;

КонецПроцедуры // УстановитьИмяОбъектаИсточник()

// Процедура заполняет данные записи при изменении правила поиска.
// 
// Параметры:
//  Нет
// 
&НаСервере
Процедура ИзменениеПравилаПоиска()

	ПравилоПоискаДанных = Запись.ПравилоПоискаДанных;
	
	Если ЗначениеЗаполнено(ПравилоПоискаДанных) Тогда
		
		Запись.ВидИнформационнойБазыИсточник = ПравилоПоискаДанных.ВидИнформационнойБазы_1;
		Запись.ВидИнформационнойБазыПриемник = ПравилоПоискаДанных.ВидИнформационнойБазы_2;
		Запись.ИмяОбъектаИсточник 			 = ПравилоПоискаДанных.ИмяОбъектаПолное_1;
		
	Иначе
		
		Запись.ВидИнформационнойБазыИсточник = Справочники.бит_мпд_ВидыИнформационныхБаз.ПустаяСсылка();
		Запись.ВидИнформационнойБазыПриемник = Справочники.бит_мпд_ВидыИнформационныхБаз.ПустаяСсылка();
		Запись.ИмяОбъектаИсточник 			 = "";
		
	КонецЕсли;

КонецПроцедуры // ИзменениеПравилаПоиска()

#КонецОбласти

