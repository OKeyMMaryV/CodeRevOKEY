#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныйПрограммныйИнтерфейс

// Функция проверяет, можно ли установить "Промежуточный счет для консолидации".
// 
// Параметры:
//  Организация - Справочник ссылка "Организации".
// 
// Возращаемое значение:
//  Булево - признак того, что можно установить "Промежуточный счет для консолидации".
// 
&НаСервере
Функция РазрешеноРедактироватьПромежуточныйСчетДляКонсолидации(Организация) Экспорт
	
	Результат = Истина;
	
	Если ЗначениеЗаполнено(Организация) Тогда
	
		// Счет нераспределенной прибыли может быть указан только для консолидирующей организации.
		ТекстЗапроса = "ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ ПЕРВЫЕ 1
		               |	бит_му_СоставПериметровКонсолидацииСрезПоследних.ПериметрКонсолидации
		               |ИЗ
		               |	РегистрСведений.бит_му_СоставПериметровКонсолидации.СрезПоследних(, Организация = &Организация) КАК бит_му_СоставПериметровКонсолидацииСрезПоследних
		               |ГДЕ
		               |	бит_му_СоставПериметровКонсолидацииСрезПоследних.ТипКонсолидации = ЗНАЧЕНИЕ(Перечисление.бит_му_ТипыКонсолидации.Консолидирующая)";
					   
		Запрос = Новый Запрос(ТекстЗапроса);
		
		Запрос.УстановитьПараметр("Организация", Организация);
		
		Результат = НЕ Запрос.Выполнить().Пустой();
		
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции // РазрешеноРедактироватьПромежуточныйСчетДляКонсолидации()

#КонецОбласти

#КонецЕсли
